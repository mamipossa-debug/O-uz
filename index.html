<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Basit Test — Efekt</title>
  <style>
    html,body{height:100%;margin:0;background:#071026;color:#fff;font-family:Arial,Helvetica,sans-serif;display:flex;align-items:center;justify-content:center}
    .card{background:rgba(255,255,255,0.03);padding:20px;border-radius:12px;text-align:center;max-width:520px;width:90%}
    #effects-layer{position:fixed;inset:0;z-index:0;pointer-events:none}
    button{margin-top:12px;padding:10px 16px;border-radius:8px;border:0;background:#ff5d7a;color:#fff;cursor:pointer}
    .secret{display:none;margin-top:12px;padding:12px;background:rgba(255,255,255,0.02);border-radius:8px;color:#fff}
    .secret.show{display:block}
  </style>
</head>
<body>
  <canvas id="effects-layer" aria-hidden="true"></canvas>

  <div class="card">
    <h2>Çalışıyor mu? Test</h2>
    <p>Butona tıkla; konsolda log, ekranda kar animasyonu ve yüzen kalp göreceksin.</p>
    <button id="toggleSecret">Sürprizi Aç / Kapat</button>
    <div id="secretArea" class="secret" role="region">Gizli mesaj burada.</div>
    <p style="font-size:12px;opacity:.7;margin-top:8px">DevTools → Console (F12) açıkken çalıştır.</p>
  </div>

  <script>
    console.log('Test sayfası: script başladı');

    // canvas hazır mı
    const canvas = document.getElementById('effects-layer');
    if(!canvas){ console.error('Canvas bulunamadı: #effects-layer'); }
    const ctx = canvas && canvas.getContext ? canvas.getContext('2d') : null;
    if(!ctx){ console.error('2D context alınamadı'); }

    function fit(){
      const dpr = window.devicePixelRatio || 1;
      canvas.width = Math.floor(window.innerWidth * dpr);
      canvas.height = Math.floor(window.innerHeight * dpr);
      canvas.style.width = window.innerWidth + 'px';
      canvas.style.height = window.innerHeight + 'px';
      if(ctx && ctx.setTransform) ctx.setTransform(dpr,0,0,dpr,0,0);
      console.log('Canvas boyutlandırıldı', canvas.width, canvas.height);
    }
    window.addEventListener('resize', fit);
    fit();

    // çok basit kar parçacıkları
    const particles = [];
    for(let i=0;i<80;i++){
      particles.push({ x: Math.random()*window.innerWidth, y: Math.random()*window.innerHeight, r: Math.random()*2+0.6, vy: Math.random()*0.6+0.2, vx: (Math.random()-0.5)*0.4 });
    }
    function frame(){
      if(!ctx) return;
      ctx.clearRect(0,0,canvas.width,canvas.height);
      ctx.fillStyle = '#fff';
      const w = window.innerWidth, h = window.innerHeight;
      for(const p of particles){
        p.y += p.vy;
        p.x += p.vx;
        if(p.y > h+10){ p.y = -10; p.x = Math.random()*w; }
        if(p.x > w+10) p.x = -10;
        if(p.x < -10) p.x = w+10;
        ctx.globalAlpha = 0.85;
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
        ctx.fill();
      }
      ctx.globalAlpha = 1;
      requestAnimationFrame(frame);
    }
    requestAnimationFrame(frame);
    console.log('Basit kar animasyonu başlatıldı');

    // buton işlevi
    const btn = document.getElementById('toggleSecret');
    const secret = document.getElementById('secretArea');
    btn.addEventListener('click', () => {
      const open = secret.classList.toggle('show');
      console.log('Butona tıklandı — open:', open);
      if(open){
        // yüzen kalp örneği
        const heart = document.createElement('div');
        heart.textContent = '❤';
        heart.style.position = 'fixed';
        heart.style.left = (window.innerWidth/2 + (Math.random()-0.5)*120) + 'px';
        heart.style.top = (window.innerHeight/2 + (Math.random()-0.5)*40) + 'px';
        heart.style.fontSize = (12 + Math.random()*20) + 'px';
        heart.style.zIndex = 3;
        heart.style.transition = 'transform 1s ease-out, opacity 1s ease-out';
        document.body.appendChild(heart);
        requestAnimationFrame(() => { heart.style.transform = 'translateY(-220px) scale(1.2)'; heart.style.opacity = '0'; });
        setTimeout(()=> heart.remove(), 1100);
      }
    });

    console.log('Event listenerlar eklendi — test hazır.');
  </script>
</body>
</html>
